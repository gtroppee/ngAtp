<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>ngAtp: Angular Autocompleter</title>
  <script src="//cdnjs.cloudflare.com/ajax/libs/lodash.js/2.4.1/lodash.min.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.22/angular.js"></script>	
  <script src="./dist/js/ngAtp-bundle.js"></script>
  <link href="./dist/css/ng-atp.css" rel="stylesheet">
  <link href="example.css" rel="stylesheet">
</head>
<body ng-app="myApp"> 
<a href="https://github.com/yiransheng/ngAtp"><img style="position: absolute; top: 0; left: 0; border: 0;" src="https://camo.githubusercontent.com/567c3a48d796e2fc06ea80409cc9dd82bf714434/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f6c6566745f6461726b626c75655f3132313632312e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_left_darkblue_121621.png"></a> 
<div ng-controller="MyCtrl" id="main" class="white-frame">  
  <h3>Angular Autocompleter: ngAtp </h3>
  <p ng-class="{ success : city }"> {{ city }} <span class="close" ng-click="clearCity()">Ã—</span></p>
  <div ng-atp="city"ng-atp-config="cityAutocompleteOpts">
    <input ng-atp-input />
    <ul ng-atp-suggestions>
    </ul>
  </div>
</div>
<div id="readme" class="white-frame">
<h2 id="quick-start">Quick Start</h2>
<p>Include <code>dist/js/ngAtp-bundle.js</code> or <code>dist/js/ngAtp-bundle.min.js</code> on your page (or use as a bower component).</p>
<pre><code>&lt;div ng-atp=&quot;city&quot; ng-atp-config=&quot;cityAutocompleteOpts&quot;&gt;
    &lt;input ng-atp-input /&gt;
    &lt;ul ng-atp-suggestions&gt;
    &lt;/ul&gt;
&lt;/div&gt;
</code></pre>

<p>Set <code>ng-atp</code> attribute value to the variable in scope you'd like to autocomplete for, same way you'd use a <code>ngModel</code> directive. Pass <a href="https://github.com/twitter/typeahead.js/blob/master/doc/bloodhound.md"><code>Bloodhound</code></a> config object using <code>ng-atp-config</code> attribute. Additonal config options: <code>idAttribute</code>, specify the key/id attribute to use for tracking suggestion items (similar to <code>track by</code> for ng-repeat). Also, you should to supply two functions in config: <code>format</code> and <code>verify</code>(optional). <code>format</code> is expected to be a function that takes a suggestion datum (eg. <code>{ label: "Thing", id: 1}</code>) into a string to display, and <code>verify</code> is expected to be a function that takes a single suggestion datum as an argument, and returns a boolean (be sure to return false for null). </p>
<p>In addition, <code>ng-atp-suggestions</code> allows you to use custom template by suppling an attribute <code>templateUrl</code>. <code>templateUrl</code> should point to a valid <code>Angular</code> template for a single suggestion item (which will be wrapped inside a <code>&lt;li&gt;</code> tag), and <code>ng-atp-suggestions</code> expose the scope variable <code>suggestion</code> for your template, as well as setting the class of the corresponding item to "selected" from user interactions (hover, and arrow key press). An example template may look like this:</p>
<pre><code>&lt;ul ng-atp-suggestions templateUrl=&quot;partials/mytemplate.html&quot;&gt;
</code></pre>

<pre><code>mytemplate.html:

&lt;div&gt;
  &lt;i class=&quot;fa {{ suggestion.icon }}&quot;&gt;&lt;/i&gt;
  &lt;span&gt;{{ suggestion.label }}&lt;/span&gt;
  &lt;img src=&quot;{{ suggestion.url }}&quot;&gt;
&lt;/div&gt;
</code></pre>

<h2 id="details">Details</h2>
<p><code>ngAtp</code> implements Twitter <code>Bloodhound</code> as a <code>Angular</code> service, <code>ngBloodhound</code> uses <code>Angular</code>'s <code>$http</code> service as opposed to <code>jQuery</code> <code>$.ajax</code> in the original version. Other than that, suggestions are entirely managed by <code>Bloodhound</code> with all its prefetching, intelligent caching, fast lookups, and backfilling. On the rendering/directive side of things, <code>ngAtp</code> relies on <code>ng-model</code> and <code>ng-repeat</code> (without filtering, which is handled by <code>Bloodhound</code>), and tries to stick to default Angular directives as
much as possilbe. </p>
</div>
<script>

var myApp = angular.module('myApp',['ngAtp']);
function MyCtrl($scope) {
  $scope.clearCity = function() {
    $scope.city = null;
  }
  $scope.city={ value: "Sigil", id: "1" };
  $scope.city2={ value: "Amn", id: "2" };
  $scope.cityAutocompleteOpts = {
    prefetch : 'data.json',
//    remote : 'http://0.0.0.0:8001/api?q=%QUERY',
    verify : function(datum) {
      return datum && _.has(datum, 'value')
    },
    limit: 25,
    clearWhenComplete : true
  };
}
</script>
</body>
</html>
